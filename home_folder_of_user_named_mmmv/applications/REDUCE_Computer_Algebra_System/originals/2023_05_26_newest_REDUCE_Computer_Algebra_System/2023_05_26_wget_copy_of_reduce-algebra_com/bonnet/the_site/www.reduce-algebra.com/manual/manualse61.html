<!DOCTYPE html> 
<html lang="en-US" xml:lang="en-US" > 
<head><title>TRIGSIMP: Simpliﬁcation and factorization of trigonometric and hyperbolic
functions</title> 
<meta  charset="utf-8" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="manual.css" /> 
<meta name="src" content="manual.tex" /> 
<script>window.MathJax = { tex: { tags: "ams", }, }; </script> 
 <script type="text/javascript" async="async" id="MathJax-script" src="../../cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>  
<meta name="description" content="The REDUCE Computer Algebra System User's Manual" /> 
</head><body 
>
<header>REDUCE</header><table cellspacing="5"><tr><td class="clinks"><a 
href="manualch8.html#manualse61.html" >Up</a></td><td class="clinks"><a 
href="manualse60.html" >Prev</a></td><td class="clinks"><a 
href="manualse60.html#tailmanualse60.html" >PrevTail</a></td><td class="clinks"><a 
href="manualse61.html#tailmanualse61.html">Tail</a></td></tr></table><h3 class="sectionHead"><span class="titlemark">8.7    </span> <a 
 id="x78-1480008.7"></a>TRIGSIMP: Simpliﬁcation and factorization of trigonometric
and hyperbolic functions</h3>
<a 
 id="dx78-148001"></a>
<a 
 id="dx78-148002"></a>
<!--l. 6--><p class="noindent" ><span 
class="ptmrc8t-x-x-109">T<span 
class="small-caps">R</span><span 
class="small-caps">I</span><span 
class="small-caps">G</span><span 
class="small-caps">S</span><span 
class="small-caps">I</span><span 
class="small-caps">M</span><span 
class="small-caps">P</span> </span>is a useful tool for all kinds of problems related to trigonometric and hyperbolic simpliﬁcation
and factorization.<span class="footnote-mark"><a 
href="manual79.html#fn1x8"><sup class="textsuperscript">1</sup></a></span><a 
 id="x78-148003f1"></a> 
There are three operators included: <span 
class="pcrr8t-x-x-109">trigsimp</span>, <span 
class="pcrr8t-x-x-109">trigfactorize </span>and <span 
class="pcrr8t-x-x-109">triggcd</span>. The
ﬁrst is for simplifying trigonometric or hyperbolic expressions and has many options, the
second is for factorizing them and the third is for ﬁnding the greatest common divisor of
two trigonometric or hyperbolic polynomials. This package is automatically loaded when
one of these operators is used.
</p>
<h4 class="subsectionHead"><span class="titlemark">8.7.1    </span> <a 
 id="x78-1490008.7.1"></a>Simplifying trigonometric expressions</h4>
<a 
 id="dx78-149001"></a>
<!--l. 19--><p class="noindent" ><a 
 id="operator:TRIGSIMP"></a> As there is no normal form for trigonometric and hyperbolic expressions, the same
function can convert in many diﬀerent directions, e.g. \(\sin (2x) \leftrightarrow 2\sin (x)\cos (x)\). The user has the possibility to
give several parameters to the operator <span 
class="pcrr8t-x-x-109">trigsimp </span>in order to inﬂuence the
transformations. It is possible to decide whether or not a rational expression involving
trigonometric and hyperbolic functions vanishes.
</p><!--l. 28--><p class="noindent" >To simplify an expression <span 
class="pcrr8t-x-x-109">f</span>, one uses <span 
class="pcrr8t-x-x-109">trigsimp(f[,options])</span>. For example:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-262">
trigsimp(sin(x)^2+cos(x)^2);

1
</pre>
<!--l. 34--><p class="nopar" > The possible options (where \(^*\) denotes the default) are:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x78-149003x1">
     <!--l. 37--><p class="noindent" ><span 
class="pcrr8t-x-x-109">sin</span>\(^*\) or <span 
class="pcrr8t-x-x-109">cos</span>;
     </p></li>
<li 
  class="enumerate" id="x78-149005x2">
     <!--l. 38--><p class="noindent" ><span 
class="pcrr8t-x-x-109">sinh</span>\(^*\) or <span 
class="pcrr8t-x-x-109">cosh</span>;
     </p></li>
<li 
  class="enumerate" id="x78-149007x3">
     <!--l. 39--><p class="noindent" ><span 
class="pcrr8t-x-x-109">expand</span>\(^*\), <span 
class="pcrr8t-x-x-109">combine </span>or <span 
class="pcrr8t-x-x-109">compact</span>;
     </p></li>
<li 
  class="enumerate" id="x78-149009x4">
     <!--l. 40--><p class="noindent" ><span 
class="pcrr8t-x-x-109">hyp</span>, <span 
class="pcrr8t-x-x-109">trig </span>or <span 
class="pcrr8t-x-x-109">expon</span>;
     </p></li>
<li 
  class="enumerate" id="x78-149011x5">
     <!--l. 41--><p class="noindent" ><span 
class="pcrr8t-x-x-109">keepalltrig</span>;
     </p></li>
<li 
  class="enumerate" id="x78-149013x6">
     <!--l. 42--><p class="noindent" ><span 
class="pcrr8t-x-x-109">tan </span>and/or <span 
class="pcrr8t-x-x-109">tanh</span>;
     </p></li>
                                                                     

                                                                     
<li 
  class="enumerate" id="x78-149015x7">
     <!--l. 43--><p class="noindent" >target arguments of the form <span 
class="ptmri8t-x-x-109">variable </span>/ <span 
class="ptmri8t-x-x-109">positive integer</span>.</p></li></ol>
<!--l. 46--><p class="noindent" >From each of the ﬁrst four groups one can use at most one option, otherwise an error
message will occur. Options can be given in any order.
</p><!--l. 50--><p class="noindent" >The ﬁrst group ﬁxes the preference used while transforming a trigonometric
expression:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-263">
trigsimp(sin(x)^2);

      2
sin(x)

trigsimp(sin(x)^2, cos);

         2
 - cos(x)  + 1
</pre>
<!--l. 62--><p class="nopar" > The second group is the equivalent for the hyperbolic functions.
</p><!--l. 65--><p class="noindent" >The third group determines the type of transformation. With the default, <span 
class="pcrr8t-x-x-109">expand</span>, an
expression is transformed to use only simple variables as arguments:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-264">
trigsimp(sin(2x+y));

                                 2
2*cos(x)*cos(y)*sin(x) - 2*sin(x) *sin(y) + sin(y)
</pre>
<!--l. 73--><p class="nopar" > With <span 
class="pcrr8t-x-x-109">combine</span>, products of trigonometric functions are transformed to trigonometric
functions involving sums of variables:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-265">
trigsimp(sin(x)*cos(y), combine);

 sin(x - y) + sin(x + y)
-------------------------
            2
</pre>
<!--l. 82--><p class="nopar" > With <span 
class="pcrr8t-x-x-109">compact</span>, the REDUCE operator <span 
class="pcrr8t-x-x-109">compact </span>(cf. section <a 
href="manualse60.html#x77-1470008.6">8.6<!--tex4ht:ref: sec:COMPACT --></a>) is applied to <span 
class="pcrr8t-x-x-109">f</span>.
This often leads to a simple form, but in contrast to <span 
class="pcrr8t-x-x-109">expand </span>one does not get a normal
form. For example:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-266">
trigsimp((1-sin(x)^2)^20*(1-cos(x)^2)^20, compact);

      40       40
cos(x)  *sin(x)
</pre>
<!--l. 92--><p class="nopar" >
</p><!--l. 94--><p class="noindent" >With an option from the fourth group, the input expression is transformed to
trigonometric, hyperbolic or exponential form respectively:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-267">
trigsimp(sin(x), hyp);

 - sinh(i*x)*i

trigsimp(sinh(x), expon);

  2*x
 e    - 1
----------
      x
   2*e

trigsimp(e^x, trig);

cos(i*x) - sin(i*x)*i
</pre>
<!--l. 113--><p class="nopar" >
</p><!--l. 115--><p class="noindent" >Usually, <span 
class="pcrr8t-x-x-109">tan</span>, <span 
class="pcrr8t-x-x-109">cot</span>, <span 
class="pcrr8t-x-x-109">sec</span>, <span 
class="pcrr8t-x-x-109">csc </span>are expressed in terms of <span 
class="pcrr8t-x-x-109">sin </span>and <span 
class="pcrr8t-x-x-109">cos</span>. It can sometimes
be useful to avoid this, which is handled by the option <span 
class="pcrr8t-x-x-109">keepalltrig</span>:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-268">
trigsimp(tan(x+y), keepalltrig);

  - (tan(x) + tan(y))
----------------------
  tan(x)*tan(y) - 1
</pre>
<!--l. 125--><p class="nopar" > Alternatively, the options <span 
class="pcrr8t-x-x-109">tan </span>and/or <span 
class="pcrr8t-x-x-109">tanh </span>can be given to convert the output to the
speciﬁed form as far as possible:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-269">
trigsimp(tan(x+y), tan);

  - (tan(x) + tan(y))
----------------------
  tan(x)*tan(y) - 1
</pre>
<!--l. 134--><p class="nopar" > By default, the other functions used will be <span 
class="pcrr8t-x-x-109">cos </span>and/or <span 
class="pcrr8t-x-x-109">cosh</span>, unless the other desired
functions are also speciﬁed in which case this choice will be respected.
</p><!--l. 139--><p class="noindent" >The ﬁnal possibility is to specify additional target arguments for the trigonometric or
hyperbolic functions, each of which should have the form of a variable divided by a
positive integer. These additional arguments are treated as if they had occurred within the
expression to be simpliﬁed, and their denominators are used in determining the overall
denominator to use for each variable in the simpliﬁed form:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-270">
trigsimp(csc x - cot x + csc y - cot y, x/2, y/2, tan);

     x          y
tan(---) + tan(---)
     2          2
</pre>
<!--l. 152--><p class="nopar" >
</p><!--l. 154--><p class="noindent" >It is possible to use the options of diﬀerent groups simultaneously:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-271">
trigsimp(sin(x)^4, cos, combine);

 cos(4*x) - 4*cos(2*x) + 3
---------------------------
             8
</pre>
<!--l. 161--><p class="nopar" >
</p><!--l. 163--><p class="noindent" >Sometimes, it is necessary to handle an expression in separate steps:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-272">
trigsimp((sinh(x)+cosh(x))^n+(cosh(x)-sinh(x))^n, expon);

  1   n    n*x
(----)  + e
   x
  e

trigsimp(ws, hyp);

2*cosh(n*x)

trigsimp((cosh(a*n)*sinh(a)*sinh(p)+cosh(a)*sinh(a*n)*sinh(p)+
    sinh(a - p)*sinh(a*n))/sinh(a));

cosh(a*n)*sinh(p) + cosh(p)*sinh(a*n)

trigsimp(ws, combine);

sinh(a*n + p)
</pre>
<!--l. 184--><p class="nopar" >
</p><!--l. 186--><p class="noindent" >The <span 
class="pcrr8t-x-x-109">trigsimp </span>operator can be applied to equations, lists and matrices (and
compositions thereof) as well as scalar expressions, and automatically maps itself
recursively over such non-scalar data structures:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-273">
trigsimp( { sin(2x) = cos(2x) } );

                            2
{2*cos(x)*sin(x)= - 2*sin(x)  + 1}
</pre>
<!--l. 195--><p class="nopar" >
</p><!--l. 198--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">8.7.2    </span> <a 
 id="x78-1500008.7.2"></a>Factorizing trigonometric expressions</h4>
<a 
 id="dx78-150001"></a>
<!--l. 200--><p class="noindent" ><a 
 id="operator:TRIGFACTORIZE"></a>
</p><!--l. 202--><p class="noindent" >With <span 
class="pcrr8t-x-x-109">trigfactorize(p,x) </span>one can factorize the trigonometric or hyperbolic
polynomial <span 
class="pcrr8t-x-x-109">p </span>in terms of trigonometric functions of the argument <span 
class="pcrr8t-x-x-109">x</span>. The output has the
same format as that from the standard REDUCE operator <span 
class="pcrr8t-x-x-109">factorize</span>. For
example:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-274">
trigfactorize(sin(x), x/2);

             x            x
{{2,1},{sin(---),1},{cos(---),1}}
             2            2
</pre>
<!--l. 213--><p class="nopar" > If the polynomial is not coordinated or balanced <span class="cite">[<a 
href="manualap2.html#XRoach:Talk">Roa</a>]</span>, the output will equal the
input. In this case, changing the value for <span 
class="pcrr8t-x-x-109">x </span>can help to ﬁnd a factorization,
e.g.
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-275">
trigfactorize(1+cos(x), x);

{{cos(x) + 1,1}}

trigfactorize(1+cos(x), x/2);

             x
{{2,1},{cos(---),2}}
             2
</pre>
<!--l. 227--><p class="nopar" > The polynomial can consist of both trigonometric and hyperbolic functions:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-276">
trigfactorize(sin(2x)*sinh(2x), x);

{{4,1}, {sinh(x),1}, {cosh(x),1}, {sin(x),1}, {cos(x),1}}
</pre>
<!--l. 233--><p class="nopar" >
</p><!--l. 235--><p class="noindent" >The <span 
class="pcrr8t-x-x-109">trigfactorize </span>operator respects the standard REDUCE <span 
class="pcrr8t-x-x-109">factorize </span>switch
<span 
class="pcrr8t-x-x-109">nopowers </span>– see the REDUCE manual for details. Turning it on gives the behaviour that
was standard before REDUCE 3.7:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-277">
on nopowers;

trigfactorize(1+cos(x), x/2);

        x        x
{2,cos(---),cos(---)}
        2        2
</pre>
<!--l. 247--><p class="nopar" >
</p><!--l. 250--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">8.7.3    </span> <a 
 id="x78-1510008.7.3"></a>GCDs of trigonometric expressions</h4>
<a 
 id="dx78-151001"></a>
<!--l. 252--><p class="noindent" ><a 
 id="operator:TRIGGCD"></a>
</p><!--l. 254--><p class="noindent" >The operator <span 
class="pcrr8t-x-x-109">triggcd </span>is essentially an application of the algorithm behind
<span 
class="pcrr8t-x-x-109">trigfactorize</span>. With its help the user can ﬁnd the greatest common divisor of two
trigonometric or hyperbolic polynomials. It uses the method described in <span class="cite">[<a 
href="manualap2.html#XRoach:Talk">Roa</a>]</span>. The
syntax is <span 
class="pcrr8t-x-x-109">triggcd(p,q,x)</span>, where <span 
class="pcrr8t-x-x-109">p </span>and <span 
class="pcrr8t-x-x-109">q </span>are the trigonometric polynomials and <span 
class="pcrr8t-x-x-109">x </span>is
the argument to use. For example:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-278">
triggcd(sin(x), 1+cos(x), x/2);

     x
cos(---)
     2

triggcd(sin(x), 1+cos(x), x);

1
</pre>
<!--l. 271--><p class="nopar" > The polynomials \(p\) and \(q\) can consist of both trigonometric and hyperbolic functions:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-279">
triggcd(sin(2x)*sinh(2x), (1-cos(2x))*(1+cosh(2x)), x);

cosh(x)*sin(x)
</pre>
<!--l. 278--><p class="nopar" >
</p><!--l. 281--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">8.7.4    </span> <a 
 id="x78-1520008.7.4"></a>Further Examples</h4>
<!--l. 283--><p class="noindent" >With the help of this package the user can create identities:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-280">
trigsimp(tan(x)*tan(y));

 sin(x)*sin(y)
---------------
 cos(x)*cos(y)

trigsimp(ws, combine);
</pre>
<!--l. 292--><p class="nopar" >
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-281">
 cos(x - y) - cos(x + y)
-------------------------
 cos(x - y) + cos(x + y)
</pre>
<!--l. 299--><p class="nopar" >
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-282">
trigsimp((sin(x-a)+sin(x+a))/(cos(x-a)+cos(x+a)));

 sin(x)
--------
 cos(x)

trigsimp(cosh(n*acosh(x))-cos(n*acos(x)), trig);

0

trigsimp(sec(a-b), keepalltrig);

  csc(a)*csc(b)*sec(a)*sec(b)
-------------------------------
 csc(a)*csc(b) + sec(a)*sec(b)

trigsimp(tan(a+b), keepalltrig);

  - (tan(a) + tan(b))
----------------------
  tan(a)*tan(b) - 1

trigsimp(ws, keepalltrig, combine);

tan(a + b)
</pre>
<!--l. 327--><p class="nopar" >
</p><!--l. 329--><p class="noindent" >Some diﬃcult expressions can be simpliﬁed:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-283">
df(sqrt(1+cos(x)), x, 4);

            5           4            3       2            3
( - 4*cos(x)  - 4*cos(x)  - 20*cos(x) *sin(x)  + 12*cos(x)

             2       2            2                   4
  - 24*cos(x) *sin(x)  + 20*cos(x)  - 15*cos(x)*sin(x)

                    2                       4            2
  + 12*cos(x)*sin(x)  + 8*cos(x) - 15*sin(x)  + 16*sin(x) )/

(16*sqrt(cos(x) + 1)

         4           3           2
 *(cos(x)  + 4*cos(x)  + 6*cos(x)  + 4*cos(x) + 1))

on rationalize;
trigsimp(ws);

 sqrt(cos(x) + 1)
------------------
        16

off rationalize;
load_package taylor;

taylor(sin(x+a)*cos(x+b), x, 0, 4);

cos(b)*sin(a) + (cos(a)*cos(b) - sin(a)*sin(b))*x

                                    2
 - (cos(a)*sin(b) + cos(b)*sin(a))*x

    2*( - cos(a)*cos(b) + sin(a)*sin(b))   3
 + --------------------------------------*x
                     3

    cos(a)*sin(b) + cos(b)*sin(a)   4      5
                                                                     

                                                                     
 + -------------------------------*x  + O(x )
                  3

trigsimp(ws, combine);

 sin(a - b) + sin(a + b)                               2
------------------------- + cos(a + b)*x - sin(a + b)*x
            2

    2*cos(a + b)   3    sin(a + b)   4      5
 - --------------*x  + ------------*x  + O(x )
         3                  3
</pre>
<!--l. 381--><p class="nopar" >
</p><!--l. 383--><p class="noindent" >Certain integrals whose evaluation was not possible in REDUCE (without preprocessing)
are now computable:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-284">
int(trigsimp(sin(x+y)*cos(x-y)*tan(x)), x);

       2
(cos(x) *x - cos(x)*sin(x) - 2*cos(y)*log(cos(x))*sin(y)

          2
  + sin(x) *x)/2

int(trigsimp(sin(x+y)*cos(x-y)/tan(x)), x);

                                   x  2
(cos(x)*sin(x) - 2*cos(y)*log(tan(---)  + 1)*sin(y)
                                   2

                      x
  + 2*cos(y)*log(tan(---))*sin(y) + x)/2
                      2
</pre>
<!--l. 403--><p class="nopar" > Without the package, the integration fails, and in the second case one does not receive an
answer for many hours.
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-285">
trigfactorize(sin(2x)*cos(y)^2, y/2);

{{2*cos(x)*sin(x),1},

       y          y
 {cos(---) - sin(---),2},
       2          2

       y          y
 {cos(---) + sin(---),2}}
       2          2
</pre>
<!--l. 419--><p class="nopar" >
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-286">
trigfactorize(sin(y)^4-x^2, y);

        2               2
{{sin(y)  + x,1},{sin(y)  - x,1}}

trigfactorize(sin(x)*sinh(x), x/2);

{{4,1},

        x
 {sinh(---),1},
        2

        x
 {cosh(---),1},
        2

       x
 {sin(---),1},
       2

       x
 {cos(---),1}}
       2

triggcd(-5+cos(2x)-6sin(x), -7+cos(2x)-8sin(x), x/2);

       x        x
2*cos(---)*sin(---) + 1
       2        2

triggcd(1-2cosh(x)+cosh(2x), 1+2cosh(x)+cosh(2x), x/2);

        x  2
2*sinh(---)  + 1
        2
</pre>
<!--l. 457--><p class="nopar" >
                                                                     

                                                                     
                                                                     

                                                                     
                                                                     

                                                                     
                                                                     

                                                                     
                                                                     

                                                                     
</p><!--l. 1--><p class="noindent" ><table cellspacing="5"><tr><td class="clinks"><a 
href="manualch8.html#manualse61.html" >Up</a></td><td class="clinks"><a 
href="manualse60.html" >Prev</a></td><td class="clinks"><a 
href="manualse60.html#tailmanualse60.html" >PrevTail</a></td><td class="clinks"><a 
href="manualse61.html" >Front</a></td></tr></table><a 
 id="tailmanualse61.html"></a>  <hr> <p style="font-family:sans-serif">Hosted by <a href="https://sourceforge.net/p/reduce-algebra/"> <img title="Download REDUCE" alt="Download REDUCE" style="vertical-align:middle" src="https://sourceforge.net/sflogo.php?type=16&amp;group_id=248416"/></a> <a href="https://www.mathjax.org"> <img title="Powered by MathJax" alt="Powered by MathJax" style="float:right" src="https://www.mathjax.org/badge/badge.gif"/></a></p></p> 
</body> 
</html>