<!DOCTYPE html> 
<html lang="en-US" xml:lang="en-US" > 
<head><title>AVECTOR: A Vector Algebra and Calculus Package</title> 
<meta  charset="utf-8" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="manual.css" /> 
<meta name="src" content="manual.tex" /> 
<script>window.MathJax = { tex: { tags: "ams", }, }; </script> 
 <script type="text/javascript" async="async" id="MathJax-script" src="../../cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>  
<meta name="description" content="The REDUCE Computer Algebra System User's Manual" /> 
</head><body 
>
<header>REDUCE</header><table cellspacing="5"><tr><td class="clinks"><a 
href="../manual-lookup.php%3FUser&#32;Contributed&#32;Packages.html#manualse127.html" >Up</a></td><td class="clinks"><a 
href="manualse128.html" >Next</a></td><td class="clinks"><a 
href="manualse126.html" >Prev</a></td><td class="clinks"><a 
href="manualse126.html#tailmanualse126.html" >PrevTail</a></td><td class="clinks"><a 
href="manualse127.html#tailmanualse127.html">Tail</a></td></tr></table><h3 class="sectionHead"><span class="titlemark">20.4    </span> <a 
 id="x167-34300020.4"></a>AVECTOR: A Vector Algebra and Calculus
Package</h3>
<a 
 id="dx167-343001"></a>
<a 
 id="dx167-343002"></a>
<!--l. 143--><p class="noindent" >This package provides REDUCE with the ability to perform vector algebra using the
same notation as scalar algebra. The basic algebraic operations are supported, as are
diﬀerentiation and integration of vectors with respect to scalar variables, cross product
and dot product, component manipulation and application of scalar functions (e.g.
cosine) to a vector to yield a vector result.
</p><!--l. 150--><p class="noindent" >Author: David Harper.
<a 
 id="dx167-343003"></a>
<a 
 id="dx167-343004"></a>
</p><!--l. 6--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">20.4.1    </span> <a 
 id="x167-34400020.4.1"></a>Introduction</h4>
<!--l. 8--><p class="noindent" >This package (<span class="cite">[<a 
href="manualap2.html#XHarper:89a">Har89</a>]</span>) provides REDUCE with the ability to perform vector algebra
using the same notation as scalar algebra. The basic algebraic operations are supported,
as are diﬀerentiation and integration of vectors with respect to scalar variables, cross
product and dot product, component manipulation and application of scalar functions,
e.g., cosine) to a vector to yield a vector result.
</p><!--l. 19--><p class="noindent" >A set of vector calculus operators are provided for use with any orthogonal
curvilinear coordinate system. These operators are gradient, divergence, curl
and del-squared (Laplacian). The Laplacian operator can take scalar or vector
arguments.
</p><!--l. 24--><p class="noindent" >Several important coordinate systems are pre-deﬁned and can be invoked by name. It is
also possible to create new coordinate systems by specifying the names of the
coordinates and the values of the scale factors.
</p><!--l. 29--><p class="noindent" >
</p>
                                                                     

                                                                     
<h4 class="subsectionHead"><span class="titlemark">20.4.2    </span> <a 
 id="x167-34500020.4.2"></a>Vector declaration and initialisation</h4>
<!--l. 31--><p class="noindent" >Any name may be declared to be a vector, provided that it has not previously been
declared as a matrix or an array. To declare a list of names to be vectors use the <span 
class="pcrr8t-x-x-109">vec</span>
command: <a 
 id="dx167-345001"></a> <a 
 id="command:VEC"></a>
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-659">
   vec a,b,c;
</pre>
<!--l. 38--><p class="nopar" > declares the variables <span 
class="pcrr8t-x-x-109">a</span>, <span 
class="pcrr8t-x-x-109">b </span>and <span 
class="pcrr8t-x-x-109">c </span>to be vectors. If they have already been assigned
(scalar) values, these will be lost.
</p><!--l. 42--><p class="noindent" >When a vector is declared using the <span 
class="pcrr8t-x-x-109">vec </span>command, it does not have an initial
value.
</p><!--l. 45--><p class="noindent" >If a vector value is assigned to a scalar variable, then that variable will automatically be
declared as a vector and the user will be notiﬁed that this has happened.
<a 
 id="dx167-345002"></a>
</p><!--l. 50--><p class="noindent" ><a 
 id="operator:AVEC"></a> A vector may be initialised using the <span 
class="pcrr8t-x-x-109">avec </span>function which takes three scalar arguments
and returns a vector made up from those scalars. For example
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-660">
   a := avec(a1, a2, a3);
</pre>
<!--l. 56--><p class="nopar" > sets the components of the vector <span 
class="pcrr8t-x-x-109">a </span>to <span 
class="pcrr8t-x-x-109">a1</span>, <span 
class="pcrr8t-x-x-109">a2 </span>and <span 
class="pcrr8t-x-x-109">a3</span>.
</p><!--l. 59--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">20.4.3    </span> <a 
 id="x167-34600020.4.3"></a>Vector algebra</h4>
<!--l. 61--><p class="noindent" >(In the examples which follow, <span 
class="pcrr8t-x-x-109">v</span>, <span 
class="pcrr8t-x-x-109">v1</span>, <span 
class="pcrr8t-x-x-109">v2</span>, etc. are assumed to be vectors while <span 
class="pcrr8t-x-x-109">s</span>, <span 
class="pcrr8t-x-x-109">s1</span>,
<span 
class="pcrr8t-x-x-109">s2</span>, etc. are scalars.)
<a 
 id="dx167-346001"></a>
<a 
 id="dx167-346002"></a>
<a 
 id="dx167-346003"></a>
<a 
 id="dx167-346004"></a>
</p><!--l. 68--><p class="noindent" >The scalar algebra operators +,-,* and / may be used with vector operands according to
the rules of vector algebra. Thus multiplication and division of a vector by a
scalar are both allowed, but it is an error to multiply or divide one vector by
another.
</p>
<div class="tabular"> <table id="TBL-30" class="tabular" 
 
><colgroup id="TBL-30-1g"><col 
id="TBL-30-1" /><col 
id="TBL-30-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-30-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-30-1-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := v1 + v2 - v3;</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-30-1-2"  
class="td11">Addition and subtraction</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-30-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-30-2-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := s1*3*v1;     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-30-2-2"  
class="td11">Scalar multiplication      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-30-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-30-3-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := v1/s;        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-30-3-2"  
class="td11">Scalar division                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-30-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-30-4-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := -v1;         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-30-4-2"  
class="td11">Negation                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-30-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-30-5-1"  
class="td11">                  </td>
</tr></table></div>
<a 
 id="dx167-346005"></a>
<a 
 id="dx167-346006"></a>
<a 
 id="dx167-346007"></a>
<!--l. 82--><p class="noindent" ><a 
 id="operator:DOT"></a> <a 
 id="operator:CROSS"></a><a 
 id="dx167-346008"></a>Vector multiplication is carried out using the inﬁx operators <span 
class="pcrr8t-x-x-109">dot </span>and <span 
class="pcrr8t-x-x-109">cross</span>.
These are deﬁned to have higher precedence than scalar multiplication and
division.
</p>
<div class="tabular"> <table id="TBL-31" class="tabular" 
 
><colgroup id="TBL-31-1g"><col 
id="TBL-31-1" /><col 
id="TBL-31-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-31-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-31-1-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := v1 cross v2;       </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-31-1-2"  
class="td11">Cross product</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-31-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-31-2-1"  
class="td11"><span 
class="pcrr8t-x-x-109">s := v1 dot v2;         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-31-2-2"  
class="td11">Dot product   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-31-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-31-3-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := v1 cross v2 + v3;  </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-31-3-2"  
class="td11">         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-31-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-31-4-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := (v1 cross v2) + v3;</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-31-4-2"  
class="td11">         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-31-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-31-5-1"  
class="td11">                        </td>
</tr></table></div>
                                                                     

                                                                     
<!--l. 97--><p class="noindent" >The last two expressions are equivalent due to the precedence of the <span 
class="pcrr8t-x-x-109">cross</span>
operator.
<a 
 id="dx167-346009"></a>
</p><!--l. 101--><p class="noindent" ><a 
 id="operator:VMOD"></a> The modulus of a vector may be calculated using the <span 
class="pcrr8t-x-x-109">VMOD </span>operator.
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-661">
   s := vmod v;
</pre>
<!--l. 105--><p class="nopar" > A unit vector may be generated from any vector using the <span 
class="pcrr8t-x-x-109">vmod </span>operator.
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-662">
   v1 := v/(vmod v);
</pre>
<!--l. 110--><p class="nopar" > Components may be extracted from any vector using index notation in the same way as
an array.
</p>
<div class="tabular"> <table id="TBL-32" class="tabular" 
 
><colgroup id="TBL-32-1g"><col 
id="TBL-32-1" /><col 
id="TBL-32-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-32-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-32-1-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := avec(ax, ay, az);</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-32-1-2"  
class="td11">      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-32-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-32-2-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v(0);                 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-32-2-2"  
class="td11">yields ax</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-32-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-32-3-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v(1);                 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-32-3-2"  
class="td11">yields ay</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-32-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-32-4-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v(2);                 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-32-4-2"  
class="td11">yields az</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-32-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-32-5-1"  
class="td11">                      </td>
</tr></table></div>
<!--l. 121--><p class="noindent" >It is also possible to set values of individual components. Following from above:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-663">
   v(1) := b;
</pre>
<!--l. 125--><p class="nopar" > The vector <span 
class="pcrr8t-x-x-109">v </span>now has components <span 
class="pcrr8t-x-x-109">ax</span>, <span 
class="pcrr8t-x-x-109">b</span>, <span 
class="pcrr8t-x-x-109">az</span>.
<a 
 id="dx167-346010"></a>
<a 
 id="dx167-346011"></a>
<a 
 id="dx167-346012"></a>
<a 
 id="dx167-346013"></a>
</p><!--l. 130--><p class="noindent" >Vectors may be used as arguments in the diﬀerentiation and integration routines in place
of the dependent expression.
</p>
<div class="tabular"> <table id="TBL-33" class="tabular" 
 
><colgroup id="TBL-33-1g"><col 
id="TBL-33-1" /><col 
id="TBL-33-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-33-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-33-1-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := avec(x**2, sin(x), y);</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-33-1-2"  
class="td11">                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-33-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-33-2-1"  
class="td11"><span 
class="pcrr8t-x-x-109">df(v,x);                   </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-33-2-2"  
class="td11">yields (2*x, cos(x), 0)          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-33-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-33-3-1"  
class="td11"><span 
class="pcrr8t-x-x-109">int(v,x);                  </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-33-3-2"  
class="td11">yields (x**3/3, -cos(x), y*x)</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-33-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-33-4-1"  
class="td11">                           </td>
</tr></table></div>
<!--l. 139--><p class="noindent" >Vectors may be given as arguments to monomial functions such as <span 
class="pcrr8t-x-x-109">sin</span>, <span 
class="pcrr8t-x-x-109">log </span>and <span 
class="pcrr8t-x-x-109">tan</span>.
The result is a vector obtained by applying the function component-wise to the argument
vector.
</p>
<div class="tabular"> <table id="TBL-34" class="tabular" 
 
><colgroup id="TBL-34-1g"><col 
id="TBL-34-1" /><col 
id="TBL-34-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-34-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-34-1-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := avec(a1, a2, a3);</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-34-1-2"  
class="td11">                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-34-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-34-2-1"  
class="td11"><span 
class="pcrr8t-x-x-109">sin(v);               </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-34-2-2"  
class="td11">yields (sin(a1), sin(a2), sin(a3))</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-34-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-34-3-1"  
class="td11">                      </td>
</tr></table></div>
<!--l. 148--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">20.4.4    </span> <a 
 id="x167-34700020.4.4"></a> Vector calculus</h4>
<a 
 id="dx167-347001"></a>
<a 
 id="dx167-347002"></a>
<a 
 id="dx167-347003"></a>
<a 
 id="dx167-347004"></a>
<a 
 id="dx167-347005"></a>
<a 
 id="dx167-347006"></a>
<a 
 id="dx167-347007"></a>
<a 
 id="dx167-347008"></a>
<!--l. 154--><p class="noindent" ><a 
 id="operator:DIV"></a> <a 
 id="operator:GRAD"></a> <a 
 id="operator:CURL"></a> <a 
 id="operator:DELSQ"></a> The vector calculus operators <span 
class="pcrr8t-x-x-109">div</span>, <span 
class="pcrr8t-x-x-109">grad </span>and <span 
class="pcrr8t-x-x-109">curl </span>are recognised. The
                                                                     

                                                                     
Laplacian operator is also available and may be applied to scalar and vector
arguments.
</p>
<div class="tabular"> <table id="TBL-35" class="tabular" 
 
><colgroup id="TBL-35-1g"><col 
id="TBL-35-1" /><col 
id="TBL-35-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-35-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-35-1-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := grad s;  </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-35-1-2"  
class="td11">Gradient of a scalar ﬁeld     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-35-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-35-2-1"  
class="td11"><span 
class="pcrr8t-x-x-109">s := div v;   </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-35-2-2"  
class="td11">Divergence of a vector ﬁeld</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-35-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-35-3-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := curl v1; </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-35-3-2"  
class="td11">Curl of a vector ﬁeld           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-35-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-35-4-1"  
class="td11"><span 
class="pcrr8t-x-x-109">s := delsq s1;</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-35-4-2"  
class="td11">Laplacian of a scalar ﬁeld   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-35-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-35-5-1"  
class="td11"><span 
class="pcrr8t-x-x-109">v := delsq v1;</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-35-5-2"  
class="td11">Laplacian of a vector ﬁeld  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-35-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-35-6-1"  
class="td11">              </td>
</tr></table></div>
<!--l. 170--><p class="noindent" >These operators may be used in any orthogonal curvilinear coordinate system.
The user may alter the names of the coordinates and the values of the scale
factors. Initially the coordinates are <span 
class="pcrr8t-x-x-109">x</span>, <span 
class="pcrr8t-x-x-109">y </span>and <span 
class="pcrr8t-x-x-109">z </span>and the scale factors are all
unity.
<a 
 id="dx167-347009"></a>
<a 
 id="dx167-347010"></a>
</p><!--l. 176--><p class="noindent" ><a 
 id="reserved:COORDS"></a> <a 
 id="reserved:HFACTORS"></a> There are two special vectors : <span 
class="pcrr8t-x-x-109">coords </span>contains the names of the coordinates in the
current system and <span 
class="pcrr8t-x-x-109">hfactors </span>contains the values of the scale factors.
<a 
 id="dx167-347011"></a>
</p><!--l. 183--><p class="noindent" ><a 
 id="operator:COORDINATES"></a> The coordinate names may be changed using the <span 
class="pcrr8t-x-x-109">coordinates </span>command.
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-664">
   coordinates r,theta,phi;
</pre>
<!--l. 188--><p class="nopar" > This command changes the coordinate names to <span 
class="pcrr8t-x-x-109">r</span>, <span 
class="pcrr8t-x-x-109">theta </span>and <span 
class="pcrr8t-x-x-109">phi</span>.
<a 
 id="dx167-347012"></a>
</p><!--l. 193--><p class="noindent" ><a 
 id="operator:SCALEFACTORS"></a> The scale factors may be altered using the <span 
class="pcrr8t-x-x-109">scalefactors </span>operator.
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-665">
   scalefactors(1,r,r*sin(theta));
</pre>
<!--l. 197--><p class="nopar" > This command changes the scale factors to <span 
class="pcrr8t-x-x-109">1</span>, <span 
class="pcrr8t-x-x-109">r </span>and <span 
class="pcrr8t-x-x-109">r sin(theta)</span>.
</p><!--l. 200--><p class="noindent" >Note that the arguments of <span 
class="pcrr8t-x-x-109">scalefactors </span>must be enclosed in parentheses. This is
not necessary with the <span 
class="pcrr8t-x-x-109">coordinates </span>command.
</p><!--l. 204--><p class="noindent" >When vector diﬀerential operators are applied to an expression, the current set of
coordinates are used as the independent variables and the scale factors are employed in
the calculation. (See, for example, Batchelor G.K. ’An Introduction to Fluid Mechanics’,
Appendix 2.)
<a 
 id="dx167-347013"></a>
</p><!--l. 212--><p class="noindent" ><a 
 id="reserved:!*CSYSTEMS"></a> Several coordinate systems are pre-deﬁned and may be invoked by name. To see a list of
valid names enter
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-666">
   symbolic !*csystems;
</pre>
<!--l. 217--><p class="nopar" > and REDUCE will respond with something like
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-667">
   (cartesian spherical cylindrical)
</pre>
<!--l. 221--><p class="nopar" >
<a 
 id="dx167-347014"></a>
</p><!--l. 224--><p class="noindent" ><a 
 id="command:GETCSYSTEM"></a> To choose a coordinate system by name, use the command <span 
class="pcrr8t-x-x-109">getcsystem</span>.
</p><!--l. 227--><p class="noindent" >To choose the Cartesian coordinate system :
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-668">
   getcsystem ’cartesian;
</pre>
<!--l. 230--><p class="nopar" > <a 
 id="dx167-347015"></a> <a 
 id="command:PUTCSYSTEM"></a> Note the quote which preﬁxes the name of the coordinate system. This is required
because <span 
class="pcrr8t-x-x-109">getcsystem </span>(and its complement <span 
class="pcrr8t-x-x-109">putcsystem</span>) is a <span 
class="pcrr8t-x-x-109">symbolic </span>procedure
which requires a literal argument.
</p><!--l. 238--><p class="noindent" >REDUCE responds by typing a list of the coordinate names in that coordinate system.
The example above would produce the response
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-669">
   (x y z)
</pre>
<!--l. 242--><p class="nopar" > whilst
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-670">
   getcsystem ’spherical;
</pre>
<!--l. 246--><p class="nopar" > would produce
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-671">
   (r theta phi)
</pre>
<!--l. 250--><p class="nopar" > Note that any attempt to invoke a coordinate system is subject to the same restrictions as
the implied calls to <span 
class="pcrr8t-x-x-109">coordinates </span>and <span 
class="pcrr8t-x-x-109">SCALEFACTORS</span>. In particular, <span 
class="pcrr8t-x-x-109">getcsystem</span>
fails if any of the coordinate names has been assigned a value and the previous
coordinate system remains in eﬀect.
</p><!--l. 257--><p class="noindent" >A user-deﬁned coordinate system can be assigned a name using the command
<span 
class="pcrr8t-x-x-109">putcsystem</span>. It may then be re-invoked at a later stage using <span 
class="pcrr8t-x-x-109">getcsystem</span>.
<a 
 id="x167-347016r1"></a>
</p><!--l. 261--><p class="noindent" ><span 
class="ptmb8t-x-x-109">Example 1</span><a 
 id="dx167-347017"></a>
</p><!--l. 263--><p class="noindent" >We deﬁne a general coordinate system with coordinate names <span 
class="pcrr8t-x-x-109">X</span>,<span 
class="pcrr8t-x-x-109">Y</span>,<span 
class="pcrr8t-x-x-109">Z </span>and scale factors
<span 
class="pcrr8t-x-x-109">h1</span>,<span 
class="pcrr8t-x-x-109">h2</span>,<span 
class="pcrr8t-x-x-109">h3 </span>:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-672">
   coordinates x,y,z;
   scalefactors(h1,h2,h3);
   putcsystem ’general;
</pre>
<!--l. 269--><p class="nopar" > This system may later be invoked by entering
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-673">
   getcsystem ’general;
</pre>
<!--l. 273--><p class="nopar" >
</p><!--l. 275--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">20.4.5    </span> <a 
 id="x167-34800020.4.5"></a>Volume and Line Integration</h4>
<!--l. 277--><p class="noindent" >Several functions are provided to perform volume and line integrals. These operate in any
orthogonal curvilinear coordinate system and make use of the scale factors described in
the previous section.
</p><!--l. 282--><p class="noindent" >Deﬁnite integrals of scalar and vector expressions may be calculated using the <span 
class="pcrr8t-x-x-109">defint</span>
function.
<a 
 id="x167-348001r2"></a>
</p><!--l. 285--><p class="noindent" ><span 
class="ptmb8t-x-x-109">Example 2</span><a 
 id="dx167-348002"></a>
<a 
 id="dx167-348003"></a>
<a 
 id="dx167-348004"></a>
</p><!--l. 288--><p class="noindent" ><a 
 id="operator:DEFINT"></a> <a 
 id="dx167-348005"></a>To calculate the deﬁnite integral of \(\sin (x)^2\) between 0 and 2\(\pi \) we enter
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-674">
   defint(sin(x)**2,x,0,2*pi);
</pre>
<!--l. 294--><p class="nopar" > This function is a simple extension of the <span 
class="pcrr8t-x-x-109">int </span>operator taking two extra arguments, the
lower and upper bounds of integration respectively.
<a 
 id="dx167-348006"></a>
<a 
 id="dx167-348007"></a>
</p><!--l. 300--><p class="noindent" ><a 
 id="operator:VOLINTEGRAL"></a> Deﬁnite volume integrals may be calculated using the <span 
class="pcrr8t-x-x-109">volintegral </span>function whose
syntax is as follows :
  </p><div class="syntax">
  <span 
class="pcrr8t-x-x-109">volintegral</span>(\(\langle \)<span 
class="ptmri8t-x-x-109">integrand:expression</span>\(\rangle \),\(\langle \)<span 
class="ptmri8t-x-x-109">lower-bound:vector</span>\(\rangle \),\(\langle \)<span 
class="ptmri8t-x-x-109">upper-bound:vector</span>\(\rangle \))</div>
<a 
 id="x167-348008r3"></a>
<!--l. 307--><p class="noindent" ><span 
class="ptmb8t-x-x-109">Example 3</span><a 
 id="dx167-348009"></a>
</p><!--l. 309--><p class="noindent" >In spherical polar coordinates we may calculate the volume of a sphere by integrating
unity over the range \(r\)=0 to <span 
class="pcrr8t-x-x-109">rr</span>, \(\theta \)=0 to \(\pi \), \(\phi \)=0 to 2*\(\pi \) as follows :
</p>
<div class="tabular"> <table id="TBL-36" class="tabular" 
 
><colgroup id="TBL-36-1g"><col 
id="TBL-36-1" /><col 
id="TBL-36-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-36-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-36-1-1"  
class="td11"><span 
class="pcrr8t-x-x-109">vlb := avec(0,0,0);     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-36-1-2"  
class="td11">Lower bound                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-36-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-36-2-1"  
class="td11"><span 
class="pcrr8t-x-x-109">vub := avec(rr,pi,2*pi);</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-36-2-2"  
class="td11">Upper bound in \(r, \theta , \phi \) respectively</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-36-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-36-3-1"  
class="td11"><span 
class="pcrr8t-x-x-109">volintorder := (0,1,2); </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-36-3-2"  
class="td11">The order of integration        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-36-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-36-4-1"  
class="td11"><span 
class="pcrr8t-x-x-109">volintegral(1,vlb,vub); </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-36-4-2"  
class="td11">                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-36-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-36-5-1"  
class="td11">                        </td>
</tr></table></div>
<a 
 id="dx167-348010"></a>
<!--l. 322--><p class="noindent" ><a 
 id="reserved:VOLINTORDER"></a> Note the use of the special vector <span 
class="pcrr8t-x-x-109">volintorder </span>which controls the order in which the
integrations are carried out. This vector should be set to contain the number 0, 1 and 2 in
the required order. The ﬁrst component of <span 
class="pcrr8t-x-x-109">volintorder </span>contains the index of
the ﬁrst integration variable, the second component is the index of the second
integration variable and the third component is the index of the third integration
variable.
<a 
 id="x167-348011r4"></a>
</p><!--l. 331--><p class="noindent" ><span 
class="ptmb8t-x-x-109">Example 4</span><a 
 id="dx167-348012"></a>
</p><!--l. 333--><p class="noindent" >Suppose we wish to calculate the volume of a right circular cone. This is equivalent to
integrating unity over a conical region with the bounds:
</p>
<div class="tabular"> <table id="TBL-37" class="tabular" 
 
><colgroup id="TBL-37-1g"><col 
id="TBL-37-1" /><col 
id="TBL-37-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-37-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-37-1-1"  
class="td11">z = 0 to h       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-37-1-2"  
class="td11">(h = the height of the cone)               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-37-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-37-2-1"  
class="td11">r = 0 to p z      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-37-2-2"  
class="td11">(p = ratio of base diameter to height)</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-37-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-37-3-1"  
class="td11">phi = 0 to 2*pi</td><td  style="white-space:nowrap; text-align:left;" id="TBL-37-3-2"  
class="td11">                        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-37-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-37-4-1"  
class="td11">          </td>
</tr></table>
                                                                     

                                                                     
</div>
<!--l. 343--><p class="noindent" >We evaluate the volume by integrating a series of inﬁnitesimally thin circular disks
of constant z-value. The integration is thus performed in the order : d(\(\phi \)) from
0 to \(2\pi \), dr from 0 to p*Z, dz from 0 to H. The order of the indices is thus 2, 0,
1.
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-675">
   volintorder := avec(2,0,1);
   vlb := avec(0,0,0);
   vub := avec(p*z,h,2*pi);
   volintegral(1,vlb,vub);
</pre>
<!--l. 352--><p class="nopar" > (At this stage, we replace <span 
class="pcrr8t-x-x-109">p*h </span>by <span 
class="pcrr8t-x-x-109">rr</span>, the base radius of the cone, to obtain the result in
its more familiar form.)
<a 
 id="dx167-348013"></a>
<a 
 id="dx167-348014"></a>
</p><!--l. 358--><p class="noindent" ><a 
 id="operator:LINEINT"></a><a 
 id="operator:DEFLINEINT"></a> <a 
 id="dx167-348015"></a><a 
 id="dx167-348016"></a> Line integrals may be calculated using the <span 
class="pcrr8t-x-x-109">lineint </span>and <span 
class="pcrr8t-x-x-109">deflineint </span>operators.
Their general syntax is
  </p><div class="syntax">
   <span 
class="pcrr8t-x-x-109">lineint</span>(\(\langle \)<span 
class="ptmri8t-x-x-109">vector-function</span>\(\rangle \),\(\langle \)<span 
class="ptmri8t-x-x-109">vector-curve</span>\(\rangle \),\(\langle \)<span 
class="ptmri8t-x-x-109">variable:kernel</span>\(\rangle \)) <br 
class="newline" /><span 
class="pcrr8t-x-x-109">deflineint</span>(\(\langle \)<span 
class="ptmri8t-x-x-109">vector-function</span>\(\rangle \),\(\langle \)<span 
class="ptmri8t-x-x-109">vector-curve</span>\(\rangle \),\(\langle \)<span 
class="ptmri8t-x-x-109">variable:kernel</span>\(\rangle \),\(\langle \)<span 
class="ptmri8t-x-x-109">lower-bound</span>\(\rangle \),\(\langle \)<span 
class="ptmri8t-x-x-109">upper-bound</span>\(\rangle \))</div>
<!--l. 366--><p class="noindent" >where
     </p><dl class="description"><dt class="description">
     <!--l. 368--><p class="noindent" >
\(\langle \)<span 
class="ptmbi8t-x-x-109">vector-function</span>\(\rangle \) </p></dt><dd 
class="description">
     <!--l. 368--><p class="noindent" >is any vector-valued expression;
     </p></dd><dt class="description">
     <!--l. 369--><p class="noindent" >
\(\langle \)<span 
class="ptmbi8t-x-x-109">vector-curve</span>\(\rangle \) </p></dt><dd 
class="description">
     <!--l. 369--><p class="noindent" >is a vector expression which describes the path of integration in terms of the
     independent variable;
     </p></dd><dt class="description">
     <!--l. 371--><p class="noindent" >
\(\langle \)<span 
class="ptmbi8t-x-x-109">variable</span>\(\rangle \) </p></dt><dd 
class="description">
     <!--l. 371--><p class="noindent" >is the independent variable;
     </p></dd><dt class="description">
     <!--l. 372--><p class="noindent" >
\(\langle \)<span 
class="ptmbi8t-x-x-109">lower-bound</span>\(\rangle \) </p></dt><dd 
class="description">
                                                                     

                                                                     
     <!--l. 372--><p class="noindent" >
     </p></dd><dt class="description">
     <!--l. 373--><p class="noindent" >
\(\langle \)<span 
class="ptmbi8t-x-x-109">upper-bound</span>\(\rangle \) </p></dt><dd 
class="description">
     <!--l. 373--><p class="noindent" >are the bounds of integration in terms of the independent variable.</p></dd></dl>
<a 
 id="x167-348017r5"></a>
<!--l. 377--><p class="noindent" ><span 
class="ptmb8t-x-x-109">Example 5</span><a 
 id="dx167-348018"></a>
</p><!--l. 379--><p class="noindent" >In spherical polar coordinates, we may integrate round a line of constant theta
(‘latitude’) to ﬁnd the length of such a line. The vector function is thus the tangent to
the ‘line of latitude’, (0,0,1) and the path is <span 
class="pcrr8t-x-x-109">(0,lat,phi) </span>where <span 
class="pcrr8t-x-x-109">phi </span>is the
independent variable. We show how to obtain the deﬁnite integral, i.e. from \(\phi =0\) to \(2 \pi \)
:
                                                                     

                                                                     
</p>
<pre class="verbatim" id="verbatim-676">
deflineint(avec(0,0,1),avec(0,lat,phi),phi,0,2*pi);
</pre>
<!--l. 387--><p class="nopar" >
</p><!--l. 389--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">20.4.6    </span> <a 
 id="x167-34900020.4.6"></a>Deﬁning new functions and procedures</h4>
<!--l. 391--><p class="noindent" >Most of the procedures in this package are deﬁned in symbolic mode and are
invoked by the REDUCE expression-evaluator when a vector expression is
encountered. It is not generally possible to deﬁne procedures which accept or
return vector values in algebraic mode. This is a consequence of the way in
which the REDUCE interpreter operates and it aﬀects other non-scalar data
types as well : arrays cannot be passed as algebraic procedure arguments, for
example.
</p><!--l. 399--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">20.4.7    </span> <a 
 id="x167-35000020.4.7"></a>Acknowledgements</h4>
<!--l. 401--><p class="noindent" >This package was written whilst the author was the U.K. Computer Algebra Support
Oﬃcer at the University of Liverpool Computer Laboratory.
</p><!--l. 154--><p class="noindent" >
                                                                     

                                                                     
                                                                     

                                                                     
</p><!--l. 156--><p class="noindent" ><table cellspacing="5"><tr><td class="clinks"><a 
href="../manual-lookup.php%3FUser&#32;Contributed&#32;Packages.html#manualse127.html" >Up</a></td><td class="clinks"><a 
href="manualse128.html" >Next</a></td><td class="clinks"><a 
href="manualse126.html" >Prev</a></td><td class="clinks"><a 
href="manualse126.html#tailmanualse126.html" >PrevTail</a></td><td class="clinks"><a 
href="manualse127.html" >Front</a></td></tr></table><a 
 id="tailmanualse127.html"></a>  <hr> <p style="font-family:sans-serif">Hosted by <a href="https://sourceforge.net/p/reduce-algebra/"> <img title="Download REDUCE" alt="Download REDUCE" style="vertical-align:middle" src="https://sourceforge.net/sflogo.php?type=16&amp;group_id=248416"/></a> <a href="https://www.mathjax.org"> <img title="Powered by MathJax" alt="Powered by MathJax" style="float:right" src="https://www.mathjax.org/badge/badge.gif"/></a></p></p> 
</body> 
</html>