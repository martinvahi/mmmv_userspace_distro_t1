<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Programming with lists</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,html --> 
<meta name="src" content="primer.tex"> 
<meta name="date" content="2014-05-02 18:12:00"> 
<link rel="stylesheet" type="text/css" href="primer.css"> 
</head><body 
>
   <table cellspacing="5"><tr><td class="clinks"><a 
href="primerse2.html#primersu7.html" >Up</a></td><td class="clinks"><a 
href="primersu8.html" >Next</a></td><td class="clinks"><a 
href="primersu6.html" >Prev</a></td><td class="clinks"><a 
href="primersu6.html#tailprimersu6.html" >PrevTail</a></td><td class="clinks"><a 
href="primersu7.html#tailprimersu7.html">Tail</a></td></tr></table><h4 class="subsectionHead"><span class="titlemark">2.7   </span> <a 
 id="x14-100002.7"></a>Programming with lists</h4>
<!--l. 655--><p class="noindent" >There are several methods available to construct a list:
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-14">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;u&#x00A0;:=&#x00A0;nil;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;u&#x00A0;:=1&#x00A0;.&#x00A0;u;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;u&#x00A0;:=2&#x00A0;.&#x00A0;u;
</div>
<!--l. 660--><p class="nopar" > Starting with an empty list, elements are pushed on its front one after the other,
here giving (2 1). Please note the blank between the number and the dot: this is
necessary as otherwise the dot would have been parsed as part of the number
representing a floating point value.
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-15">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;u&#x00A0;:=&#x00A0;{9,10};
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;u&#x00A0;:=&#x00A0;1&#x00A0;.u;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;u&#x00A0;:=&#x00A0;2&#x00A0;.u;
</div>
<!--l. 670--><p class="nopar" > The same, here not starting with the empty list giving (2 1 9 10). The <span 
class="cmtt-10x-x-109">for</span>
<span 
class="cmtt-10x-x-109">statement</span> <a 
 id="dx14-10001"></a>has special forms to handle lists:
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmtt-10x-x-109">for each</span><a 
 id="dx14-10002"></a> <span 
class="cmmi-10x-x-109">x </span><span 
class="cmtt-10x-x-109">in </span><span 
class="cmmi-10x-x-109">l</span> <img 
src="primer5x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" > performs an action elementwise for the elements
     in list <span 
class="cmmi-10x-x-109">l</span>; the elements are accessible by the automatically declared local
     variable <span 
class="cmmi-10x-x-109">x </span>one after the other.
     </li>
     <li class="itemize">the iterator actions <span 
class="cmtt-10x-x-109">collect</span><a 
 id="dx14-10003"></a> and <span 
class="cmtt-10x-x-109">join</span> <a 
 id="dx14-10004"></a>allow you to construct lists:
          <ul class="itemize2">
          <li class="itemize"><span 
class="cmtt-10x-x-109">collect </span>generates  a  list  where  each  iteration  step  produces
          exactly one element,
          </li>
          <li class="itemize"><span 
class="cmtt-10x-x-109">join </span>expects that each iteration step produces a complete list (or
          <span 
class="cmmi-10x-x-109">nil</span>) and joins them to one long list.</li></ul>
     </li></ul>
<!--l. 689--><p class="noindent" >Examples: let e.g.&#x00A0;<span 
class="cmmi-10x-x-109">l </span>be a list of numbers (1  <span 
class="cmsy-10x-x-109">- </span>2 3  <span 
class="cmsy-10x-x-109">- </span>4 5  <span 
class="cmsy-10x-x-109">- </span>6):
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-16">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;m:=for&#x00A0;each&#x00A0;x&#x00A0;in&#x00A0;l&#x00A0;sum&#x00A0;x;
</div>
<!--l. 693--><p class="nopar" > <span 
class="cmmi-10x-x-109">m </span>will be the sum of the elements,
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-17">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;s:=for&#x00A0;each&#x00A0;x&#x00A0;in&#x00A0;l&#x00A0;collect&#x00A0;x*x;
</div>
<!--l. 697--><p class="nopar" > <span 
class="cmmi-10x-x-109">s </span>is computed as list with the numbers from <span 
class="cmmi-10x-x-109">x </span>squared,
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-18">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;p:=for&#x00A0;each&#x00A0;x&#x00A0;in&#x00A0;l&#x00A0;join
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;x&#x003E;0&#x00A0;then&#x00A0;{x}&#x00A0;else&#x00A0;nil;
</div>
<!--l. 702--><p class="nopar" > in this loop the positive numbers produce one element lists, while the negative
numbers are mapped to nil; joined together the result is a list with only the
positive elements,
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-19">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;r:=for&#x00A0;i:=1:10&#x00A0;collect&#x00A0;-r;
</div>
<!--l. 709--><p class="nopar" > here the result is the list with numbers (<span 
class="cmsy-10x-x-109">-</span>1  <span 
class="cmsy-10x-x-109">- </span>2  <span 
class="cmsy-10x-x-109">- </span>3<img 
src="primer6x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" ><span 
class="cmsy-10x-x-109">- </span>10). The
lists produced by <span 
class="cmti-10x-x-109">collect </span>and <span 
class="cmti-10x-x-109">join </span>are in &#8220;correct&#8221; order. <span 
class="cmbx-10x-x-109">Warning</span>:
In symbolic mode <span 
class="cmti-10x-x-109">join </span>links the lists <span 
class="cmbx-10x-x-109">in place </span>for maximum speed
<span class="footnote-mark"><a 
href="primer15.html#fn5x0"><sup class="textsuperscript">5</sup></a></span><a 
 id="x14-10005f5"></a>:
The last <span 
class="cmti-10x-x-109">CDR </span>pointer of the first list is modified to point to the head of
the second list , and so on. This is no problem if the joined objects are
freshly built structures, or if there are no other references to them. If
the in &#8211; place operation is dangerous for your application, you must
copy the structure before, e.g. by a call to <span 
class="cmti-10x-x-109">append </span>with <span 
class="cmti-10x-x-109">NIL </span>as second
argument:
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-20">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;r:=for&#x00A0;i:=1:10&#x00A0;join&#x00A0;append(my_extract(u,r),nil);
</div>
<!--l. 726--><p class="nopar" > In this example, the top level chain of the results of <span 
class="cmti-10x-x-109">my</span><span 
class="cmti-10x-x-109">_extract </span>is copied such
that the original structure is not modified when joining.
<!--l. 732--><p class="indent" >   Another very common style for list operations is to use iterative or
recursive programs. The following programs each sum the elements of the
list:
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-21">
&#x00A0;&#x00A0;&#x00A0;symbolic&#x00A0;procedure&#x00A0;sum_1(l);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;begin&#x00A0;&#x00A0;integer&#x00A0;n;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;while&#x00A0;l&#x00A0;do&#x00A0;&#x003C;&#x003C;n:=n+car&#x00A0;l;&#x00A0;l:=cdr&#x00A0;l&#x003E;&#x003E;;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return&#x00A0;n;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;end;
</div>
<!--l. 741--><p class="nopar" > This program picks in each step of the the while loop one element from the list
and sets the variable <span 
class="cmmi-10x-x-109">l </span>to the successor position; the loop terminates as soon as
the successor <span 
class="cmmi-10x-x-109">nil </span>is found .
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-22">
&#x00A0;&#x00A0;&#x00A0;symbolic&#x00A0;procedure&#x00A0;sum_2(l);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;null&#x00A0;l&#x00A0;then&#x00A0;0&#x00A0;else&#x00A0;car&#x00A0;l&#x00A0;+&#x00A0;sum_2(cdr&#x00A0;l);
</div>
<!--l. 749--><p class="nopar" > This program uses recursion for the same task. The program will go down the
list until <span 
class="cmmi-10x-x-109">nil </span>is found, then set the sum to 0 and when coming back from the
recursion add the elements to the sum so far.
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-23">
&#x00A0;&#x00A0;&#x00A0;symbolic&#x00A0;procedure&#x00A0;sum_3(l);&#x00A0;sum_31(l,0);&#x00A0;%&#x00A0;initializing
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;symbolic&#x00A0;procedure&#x00A0;sum_31(l,n);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;null&#x00A0;l&#x00A0;then&#x00A0;n&#x00A0;else&#x00A0;sum_31(cdr&#x00A0;l,car&#x00A0;l+n);
</div>
<!--l. 758--><p class="nopar" > The third example is a bit tricky: it initializes the sum to 0, and when stepping
down in the recursion the sum is updated and passed to the next recursion level
as a parameter.
<!--l. 764--><p class="indent" >   It is also very common to produce lists in recursive style, e.g.&#x00A0;inverting the
signs in a list of numbers could be written as
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-24">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;symbolic&#x00A0;procedure&#x00A0;invertsgn(l);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;null&#x00A0;l&#x00A0;then&#x00A0;nil&#x00A0;else&#x00A0;-car&#x00A0;l&#x00A0;.&#x00A0;invertsgn(cdr&#x00A0;l);
</div>
<!--l. 769--><p class="nopar" > and with most LISP compilers this program would as efficient as the
corresponding loop
                                                                     

                                                                     
   <div class="verbatim" id="verbatim-25">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;for&#x00A0;each&#x00A0;x&#x00A0;in&#x00A0;l&#x00A0;collect&#x00A0;-x;
</div>
<!--l. 774--><p class="nopar" > but produce less code. Note that as with <span 
class="cmti-10x-x-109">for each - collect</span>, the elements in the
resulting list will be in the original order. The recursive programming style is
typical for LISP and it is used for hundreds of <span 
class="cmr-10">REDUCE </span>routines.
                                                                     

                                                                     
<!--l. 781--><p class="indent" >   <table cellspacing="5"><tr><td class="clinks"><a 
href="primerse2.html#primersu7.html" >Up</a></td><td class="clinks"><a 
href="primersu8.html" >Next</a></td><td class="clinks"><a 
href="primersu6.html" >Prev</a></td><td class="clinks"><a 
href="primersu6.html#tailprimersu6.html" >PrevTail</a></td><td class="clinks"><a 
href="primersu7.html" >Front</a></td></tr></table><a 
 id="tailprimersu7.html"></a>  
</body></html> 
