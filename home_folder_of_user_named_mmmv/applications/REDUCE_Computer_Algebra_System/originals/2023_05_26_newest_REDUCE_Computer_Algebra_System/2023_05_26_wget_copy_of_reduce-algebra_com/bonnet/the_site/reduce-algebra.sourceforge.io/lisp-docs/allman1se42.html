<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Generalized Input/Output Streams</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,html --> 
<meta name="src" content="allman1.tex"> 
<meta name="date" content="2014-05-02 18:10:00"> 
<link rel="stylesheet" type="text/css" href="allman1.css"> 
</head><body 
>
<p align="centre"><img src="https://reduce-algebra.sourceforge.io/lisp-docs/redlogo.png" width=621 height=60 border=0 alt="REDUCE"></p><table cellspacing="5"><tr><td class="clinks"><a 
href="allman1li9.html#allman1se42.html" >Up</a></td><td class="clinks"><a 
href="allman1se43.html" >Next</a></td><td class="clinks"><a 
href="allman1se41.html" >Prev</a></td><td class="clinks"><a 
href="allman1se41.html#tailallman1se41.html" >PrevTail</a></td><td class="clinks"><a 
href="allman1se42.html#tailallman1se42.html">Tail</a></td></tr></table><h3 class="sectionHead"><span class="titlemark">10.10    </span> <a 
 id="x54-13300010.10"></a>Generalized Input/Output Streams</h3>
<!--l. 1126--><p class="noindent" >All input and output functions are implemented in terms of operations on &#8221;channels&#8221;. A channel is just a
small integer <span class="footnote-mark"><a 
href="allman15.html#fn1x0">1</a></span><a 
 id="x54-133001f1"></a><span class="footnote-mark"><a 
 id="fn1x0">     1</a></span><span 
class="ptmr7t-">The range of channel numbers is from 0 to MaxChannels, where MaxChannels is a system-dependent constant,</span>
   <span 
class="ptmr7t-">currently 31, defined in the module </span><span 
class="ptmb7t-">io-decls</span>
which has 3 functions and some other information associated with it. The three functions
are:
<!--l. 1134--><p class="noindent" >
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x54-133003x1">A reading function, which is called with the channel as its argument and returns the
      integer ASCII value of the next character of the input stream. If the channel is for
      writing only, this function is writeonlychannel. If the channel has not been opened,
      this function is channelnotopen. The reading function is responsible for echoing
      characters if the flag *echo is non-nil. It should use the function writechar to echo
      the  character.  It  may  not  be  appropriate  for  a  read  function  to  echo  characters.
      For example, the &#8221;disk&#8221; reading function does echoing, while the reader used to
      implement the compress function does not.
      <!--l. 1148--><p class="noindent" >The  read  function  must  also  be  concerned  with  the  handling  of  ends  of  &#8221;files&#8221;
      (actually, ends of channels) and ends of lines. It should return the ASCII code for
      an end of file character (system dependent) when reaching the end of a channel.
      It should return the ASCII code for a line feed character to indicate an end of line
      (or &#8221;newline&#8221;). This may require that the ASCII code for carriage return be ignored
      when read, not returned.
      </li>
      <li 
  class="enumerate" id="x54-133005x2">A writing function, which is called with the channel as its first argument and the
      integer ASCII value of the character to write as its second argument. If the channel
      is for reading only, this function is readonlychannel. If the channel has not been
      opened, this function is channelnotopen.
      </li>
      <li 
  class="enumerate" id="x54-133007x3">A closing function, which is called with the channel as its argument and performs
      any action necessary for the graceful termination of input and/or output operations
      to that channel. If the channel is not open, this function is channelnotopen.</li></ol>
<!--l. 1173--><p class="noindent" >The other information associated with a channel includes the current position in the output line
(used by posn), the maximum line length allowed (used by linelength and the printing
functions), the single character input backup buffer (used by the token scanner), and other
system-dependent information.
<!--l. 1179--><p class="noindent" >Ordinarily, the user need not be aware of the existence of this mechanism. However, because of
its generality, it is possible to implement operations other than just reading from and
writing to files using it. In particular, the LISP functions explode and compress are
performed by writing to a list and reading from a list, respectively (on channels 3 and 4
respectively).

<!--l. 1187--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">10.10.1    </span> <a 
 id="x54-13400010.10.1"></a>Using the &#8221;Special&#8221; Form of Open</h4>
<!--l. 1189--><p class="noindent" >If Open is called with AccessType eq to SPECIAL and the global variables specialreadfunction*,
specialwritefunction*, and specialclosefunction* are bound to ids, then a free channel is
returned and its associated functions are set to the values of these variables. Other non
system-dependent status is set to default conditions, which can later be overridden. The
functions readonlychannel and writeonlychannel are available as error handlers. The parameter
Filename is used only if an error occurs.
<!--l. 1199--><p class="noindent" >The following globals are used by the functions in this section.
<!--l. 1202--><p class="noindent" ><div class="minipage"><a 
 id="dx54-134001"></a>
<span 
class="ptmb7t-x-x-120">specialclosefunction*  </span>= [Initially: nil]                                                                     <span 
class="ptmri7t-x-x-120">global</span>
<br 
class="newline" />&#x00A0;       &#x00A0;<div class="minipage">
</div></div><div class="minipage"><a 
 id="dx54-134002"></a>
<span 
class="ptmb7t-x-x-120">specialreadfunction* </span>= [Initially: nil]                                                                       <span 
class="ptmri7t-x-x-120">global</span>
<br 
class="newline" />&#x00A0;       &#x00A0;<div class="minipage">
</div>
</div><div class="minipage"><a 
 id="dx54-134003"></a>
<span 
class="ptmb7t-x-x-120">specialwritefunction* </span>= [Initially: nil]                                                                     <span 
class="ptmri7t-x-x-120">global</span>
<br 
class="newline" />&#x00A0;       &#x00A0;<div class="minipage">
</div>
</div>

<!--l. 1206--><p class="noindent" ><table cellspacing="5"><tr><td class="clinks"><a 
href="allman1li9.html#allman1se42.html" >Up</a></td><td class="clinks"><a 
href="allman1se43.html" >Next</a></td><td class="clinks"><a 
href="allman1se41.html" >Prev</a></td><td class="clinks"><a 
href="allman1se41.html#tailallman1se41.html" >PrevTail</a></td><td class="clinks"><a 
href="allman1se42.html" >Front</a></td></tr></table><a 
 id="tailallman1se42.html"></a>   
</body></html> 
