<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="The REDUCE Computer Algebra System" />
    <meta name="keywords" content="Open Source, Software, Development, Developers, Projects, Downloads, SF.net, SourceForge,
                    BSD License, Science/Research, OS Portable (Source code to work with many OS platforms),
                    Mathematics, Lisp, REDUCE, reduce-algebra, computer algebra system, CAS" />
    <title>
        REDUCE Tutorial: Ordinary Differential Equations    </title>
    <link rel="canonical" href="../../reduce-algebra.sourceforge.io/tutorials/ode-tutorial.php.html" />
    <link rel="icon" type="image/png" href="../images/icon.png" />
    <link rel="stylesheet" href="../../cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="../StyleSheet.css" />
</head>
<body>
    <div class="container-fluid">
        <header class="navbar navbar-expand-md navbar-light">
            <a class="navbar-brand d-none d-md-block" href="https://sourceforge.net/p/reduce-algebra/" title="REDUCE project page">
                <img src="../images/icon.png" alt="" />
            </a>
            <span class="mx-auto">REDUCE</span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navmenu">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- The following link is hidden on the search page! -->
            <a id="top-search-button" class="btn d-none d-md-block" title="Search the REDUCE web site" href="../search.php.html">
                <svg width="13" height="13" viewBox="0 0 13 13">
                    <path d="m4.8495 7.8226c0.82666 0 1.5262-0.29146 2.0985-0.87438 0.57232-0.58292 0.86378-1.2877 0.87438-2.1144 0.010599-0.82666-0.28086-1.5262-0.87438-2.0985-0.59352-0.57232-1.293-0.86378-2.0985-0.87438-0.8055-0.010599-1.5103 0.28086-2.1144 0.87438-0.60414 0.59352-0.8956 1.293-0.87438 2.0985 0.021197 0.8055 0.31266 1.5103 0.87438 2.1144 0.56172 0.60414 1.2665 0.8956 2.1144 0.87438zm4.4695 0.2115 3.681 3.6819-1.259 1.284-3.6817-3.7 0.0019784-0.69479-0.090043-0.098846c-0.87973 0.76087-1.92 1.1413-3.1207 1.1413-1.3553 0-2.5025-0.46363-3.4417-1.3909s-1.4088-2.0686-1.4088-3.4239c0-1.3553 0.4696-2.4966 1.4088-3.4239 0.9392-0.92727 2.0864-1.3969 3.4417-1.4088 1.3553-0.011889 2.4906 0.45771 3.406 1.4088 0.9154 0.95107 1.379 2.0924 1.3909 3.4239 0 1.2126-0.38043 2.2588-1.1413 3.1385l0.098834 0.090049z">
                    </path>
                </svg>
            </a>
        </header>
        <div class="row">
            ï»¿<nav id="navmenu" class="col-md-3 col-xl-2 d-md-block collapse">
    <div class="sticky-top">
        <ul>
            <li title="The REDUCE Computer Algebra System"><a href="../index.php.html">Home</a></li>
<li title="REDUCE features and design characteristics"><a href="../features.php.html">Features</a></li>
<li title="How to download, install and run REDUCE"><a href="../obtaining.php.html">Obtain and Run</a></li>
<li title="User guides for REDUCE, its packages and Lisp systems"><a href="../documentation.php.html">Documentation</a></li>
<li title="Details of books about REDUCE"><a href="../books.php.html">Books</a></li>
<li title="Answers to questions about using REDUCE"><a href="../support.php.html">Support Q & A</a></li>
<li title="Simple examples of using REDUCE"><a href="../tutorials.php.html">Tutorials</a></li>
<li title="External packages that use REDUCE"><a href="../packages.php.html">External Packages</a></li>
<li title="Join the REDUCE developer community!"><a href="../helpwanted.php.html">Help Wanted!</a></li>
<li title="Publications that reference REDUCE"><a href="../bibliography.php.html">Bibliography</a></li>
<li title="REDUCE history and contributors"><a href="../about.php.html">About REDUCE</a></li>
<li title="Projects related to REDUCE"><a href="../projects.php.html">Related Projects</a></li>
<li title="Search the REDUCE web site"><a href="../search.php.html">Search&nbsp;
      <svg width="13" height="13" viewBox="0 0 13 13">
        <path d="m4.8495 7.8226c0.82666 0 1.5262-0.29146 2.0985-0.87438 0.57232-0.58292 0.86378-1.2877 0.87438-2.1144 0.010599-0.82666-0.28086-1.5262-0.87438-2.0985-0.59352-0.57232-1.293-0.86378-2.0985-0.87438-0.8055-0.010599-1.5103 0.28086-2.1144 0.87438-0.60414 0.59352-0.8956 1.293-0.87438 2.0985 0.021197 0.8055 0.31266 1.5103 0.87438 2.1144 0.56172 0.60414 1.2665 0.8956 2.1144 0.87438zm4.4695 0.2115 3.681 3.6819-1.259 1.284-3.6817-3.7 0.0019784-0.69479-0.090043-0.098846c-0.87973 0.76087-1.92 1.1413-3.1207 1.1413-1.3553 0-2.5025-0.46363-3.4417-1.3909s-1.4088-2.0686-1.4088-3.4239c0-1.3553 0.4696-2.4966 1.4088-3.4239 0.9392-0.92727 2.0864-1.3969 3.4417-1.4088 1.3553-0.011889 2.4906 0.45771 3.406 1.4088 0.9154 0.95107 1.379 2.0924 1.3909 3.4239 0 1.2126-0.38043 2.2588-1.1413 3.1385l0.098834 0.090049z">
        </path>
      </svg></a></li>
<li title="Full REDUCE site map and recently updated files"><a href="http://www.reduce-algebra.com/sitemap.php">Site Map / Recent</a></li>
<li title="Run REDUCE as a web app in your web browser"><a href="../web-reduce/about.php%3Fstart.html">Web REDUCE</a></li>
        </ul>

        <a href="https://sourceforge.net/p/reduce-algebra/" rel="nofollow">
            <p>
	        Download REDUCE from<br />
	        <img alt="SourceForge" src="https://sourceforge.net/sflogo.php?type=13&amp;group_id=248416">
            </p>
        </a>

        <div id="google_translate_element"></div>
        <script>
         function googleTranslateElementInit() {
	     new google.translate.TranslateElement( { pageLanguage: 'en' } , 'google_translate_element');
         }
        </script>
        <script defer="defer" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    </div>
</nav>
            <div id="main" class="col-md-9 col-xl-7">
                <h1>Tutorial: Ordinary Differential Equations</h1>

<p><a href="https://sourceforge.net/users/fjwright/">Francis Wright</a>, June 2018, December 2019</p>
<p>
    Click on a problem header to show/hide my REDUCE solution.
</p>

<div class="accordion" id="P_S_accordion">

    <div>
        <!-- Problem MTH5123 Differential Equations Exam 2014 Q1 -->
        <ol style="list-style: lower-alpha">
            <li>Find a function \(f(u)\) such that the
                differential equation
	        \[ f(x + y) + \ln x + \left(e^{x+y} + y^2\right)
	        \frac{dy}{dx} = 0 \] is exact.</li>
            <li>For the chosen \(f(u)\) find the corresponding
                solution in implicit form.</li>
        </ol>
        <!-- Solution -->
        <pre>% (a)
% The ODE P(x,y) + Q(x,y)df(y,x) = 0 is exact if df(P(x,y),y) = df(Q(x,y),x).
operator f;  let ln ~x => log x;
P := f(x+y) + ln x;  Q := exp(x+y) + y^2;
df(P,y) = df(Q,x);
% Obviously, f(u) = exp(u) + constant. Check:
ws where f ~u => exp u + constant;
% (b)
% The simplest solution has constant = 0, so
let f ~u => exp u;
% p = df(u,x), where u = u(x,y), so
u := int(p,x) + uy;  depend uy, y;
q = df(u,y);
solve(ws, df(uy,y));
int(lhs eqn,y) = int(rhs eqn,y) where eqn => first ws;
% Hence, the solution of the original ODE is
on div;  sub(ws,u) = constant;
off div;  clear P, Q;</pre>
    </div>

    <div>
        <!-- Problem Q1(c) -->
        Solve the initial value problem
        \[ \frac{dy}{dx} = \sqrt{y^2 + 9}, \quad y(1) = 0. \]
        <!-- Solution -->
        <pre>depend y, x;
df(y,x) = sqrt(y^2+9);
soln := odesolve(ws, {x=1, y=0});</pre>
    </div>

    <div>
        <!-- Problem Q2 -->
        <ol style="list-style: lower-alpha">
            <li>Find the general solution of the homogeneous ODE
	        \[ y'' + 9y = 0. \]</li>
            <li>Find the general solution of the non-homogeneous
	        ODE
                \[ y'' + 9y = \sin(2x). \]</li>
            <li>Find the general solution to the first-order
	        homogeneous linear ODE
                \[ y' = \tan(x)\,y. \]</li>
            <li>Solve the initial-value problem for the
	        first-order linear non-homogeneous ODE
                \[ y' = \tan(x)\,y + 1, \quad y(0) = 2. \]</li>
        </ol>
        <!-- Solution -->
        <pre>depend y, x;
% (a)
df(y,x,2) + 9y = 0;  odesolve ws;
% (b)
df(y,x,2) + 9y = sin(2x);  odesolve ws;
% (c)
df(y,x) = tan(x)*y;  odesolve ws;
% (d)
df(y,x) = tan(x)*y + 1;  odesolve(ws, {x=0, y=2});
nodepend y, x;</pre>
    </div>

    <div>
        <!-- Problem Q3 -->
        Solve the following boundary value problem for the
        second-order non-homogeneous differential equation
        \[ \frac{d^2y}{dx^2} = x^2, \quad y(0) = 0, \quad y'(1) = 0. \]
        <!-- Solution -->
        <pre>depend y, x;
df(y,x,2) = x^2;  odesolve(ws, {{x = 0, y = 0}, {x = 1, df(y,x) = 0}});</pre>
    </div>

    <div>
        <!-- Problem Q4 -->
        Consider a system of two nonlinear first-order ODEs:
        \[ \dot{x} = -x - 3y - 3x^3, \quad \dot{y} = \frac43x - y - \frac13 x^3. \]
        <ol style="list-style: lower-alpha">
            <li>Write down in the matrix form the system obtained
	        by linearization of the above equations around the
	        point \(x = y = 0\) and find the corresponding
	        eigenvalues and eigenvectors.</li>
            <li>Find the solution of the linear system
	        corresponding to the initial conditions \(x(0) =
	        2, y(0) = 0\). Determine the type of equilibrium
	        for the system and describe in words the shape of
	        trajectory in the phase plane corresponding to the
	        specified initial conditions. Determine the
	        tangent vector to the trajectory at \(t = 0\).</li>
        </ol>
        <!-- Solution -->
        <pre>% (a)
% xdot = -x - 3y; ydot = 4/3x - y
depend {x, y}, t;
dxy := mat((df(x,t)),(df(y,t)));
coef := mat((-1,-3),(4/3,-1));
xy := mat((x),(y));
% Check:
dxy = coef*xy;

ev := mateigen(coef, lam);
evals := solve first first ev;
evecs := (third first ev where arbcomplex ~j => 1);
evecs := for each eval in evals collect sub(eval,evecs);

% (b)
matrix D(2,2);  for i := 1:2 do D(i,i) := exp(rhs part(evals,i)*t);  D;
matrix P(2,2);  for i := 1:2 do for j := 1:2 do
   P(i,j) :=  &lt;&lt;v := part(evecs,j); P(i,j) := v(i,1)>>;  P;
on div, complex;
soln := P*D*P^(-1);
soln := soln*mat((x0),(y0));  % where x(0) = x0, y(0) = y0.
%Check:
ode := dxy - coef*xy;  % = 0 ?
sub(x=soln(1,1), y=soln(2,1), ode);

x0 := 2$  y0 := 0$  soln;
% The zero solution is a stable equilibrium and nearby solutions
% spiral in towards zero.
sub(t=0, sub(x=soln(1,1), y=soln(2,1), dxy));</pre>
    </div>

    <div>
        <!-- Problem -->
        (Suggested by Tony Roberts from <a href="../books.php.html#roberts">his book</a>.)<br />
        Find the power series solution \(y(x)\) up to degree
        \(x^7\) to the differential equation
        \[ y''+(1+x)y'-6y^2=0 \] such that
        \[ y(0)=1 \mbox{ and } y'(0)=-1. \]
        <!-- Solution -->
        <pre>% The following switch settings display the solution as usual for a
% power series:
on div; off allfac; on revpri;
y := 1 - x;  % using the initial conditions
let x^8 => 0;  % truncate at degree 7
% This loop shows successive terms converging:
for iter := 1:99 do <<  % loop at most 99 times
   res := df(y,x,2) + (1+x)*df(y,x) - 6y^2;
   write y := y + (dy := -int(int(res,x),x));
   if dy = 0 then iter := 1000;  % terminate the loop
>>;

% You can also find power series for solutions of a wide range of
% related ODEs simply by changing the lines "res := ..." and applying
% the initial conditions by changing the initial assignment "y := ...".</pre>
    </div>

</div>

</div><!-- opened in begin-body.php -->

<footer class="col-xl-3">
    <div class="sticky-top">
        <hr class="d-display d-xl-none" />
        <p>
            Page last modified on
            Monday 19th July 2021.
        </p>
        <p>
            All information available through this web site is
            Copyright &copy; Anthony C. Hearn and the
            <a href="https://sourceforge.net/p/reduce-algebra/_members/">REDUCE
                developers</a> 2009&ndash;
            2023. All Rights Reserved.
        </p>
        <p>
            Please report broken links (both in-coming and out-going), other
            errors or suggestions for improvement to
            <a href="https://sites.google.com/site/fjwcentaur/feedback">webmaster</a>.
        </p>
        <p>
            This web site is built using <a href="https://www.php.net/">PHP</a>
            and <a href="https://getbootstrap.com/">Bootstrap</a>.
            It should be
            <a href="javascript:void(location.href =
                     'https://html5.validator.nu/?doc='+encodeURIComponent(location.href))"
                style="color:black;text-decoration:none;">valid</a>
            <!-- target="_blank" or holding down ctrl causes this to fail! -->
            <a href="https://en.wikipedia.org/wiki/XHTML#XHTML5">XHTML5</a>.
            Microsoft Internet Explorer does not display this web site
            correctly; please use a current web browser.
        </p>
        <div style="display: flex; flex-wrap: wrap-reverse; justify-content: space-around;">
            <!-- Begin SF Tag -->
            <div class="sf-root" data-id="248416" data-badge="oss-open-source-excellence-white"
                data-metadata="achievement=oss-open-source-excellence" style="width:125px">
                <a href="https://sourceforge.net/projects/reduce-algebra/" target="_blank">REDUCE</a>
            </div>
            <script>(function () {
                    var sc = document.createElement('script'); sc.type = 'text/javascript';
                    sc.async = true; sc.src = 'https://b.sf-syn.com/badge_js?sf_id=248416';
                    var p = document.getElementsByTagName('script')[0]; p.parentNode.insertBefore(sc, p);
                })();
            </script>
            <!-- End SF Tag -->
            <a href="https://www.mathjax.org">
                <img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif"
                    alt="Powered by MathJax" />
            </a>
        </div>
    </div>
</footer>

</div>
</div>

<!-- Bootstrap JavaScript bundle with Popper -->
<script src="../../cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
    crossorigin="anonymous"></script>

<!-- The slim version of jQuery does not include ajax (or effects)
     and I use ajax on the documentation page! -->
<script src="../../code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
        crossorigin="anonymous"></script>
<script>
 $("#P_S_accordion > div") // Complete problem markup:
     .addClass("accordion-item").prepend(function(n){
         return `<h2 class="accordion-header" id="heading${n}">
<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse${n}"
aria-expanded="false" aria-controls="collapse${n}">
Problem ${n+1}
</button>
</h2>`;
     });

 $("#P_S_accordion > div > pre") // Complete solution markup:
     .wrap(function(n){
         return `<div id="collapse${n}" class="accordion-collapse collapse" aria-labelledby="heading${n}" data-bs-parent="#P_S_accordion">
<div class="accordion-body"></div></div>`;
     })
     .parent().prepend('<h5>REDUCE solution</h5>');
</script>

<!-- Use the same URL as used for the HTML manual for cache efficiency. -->
<script id="MathJax-script" src="../../cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>

</body>
</html>
