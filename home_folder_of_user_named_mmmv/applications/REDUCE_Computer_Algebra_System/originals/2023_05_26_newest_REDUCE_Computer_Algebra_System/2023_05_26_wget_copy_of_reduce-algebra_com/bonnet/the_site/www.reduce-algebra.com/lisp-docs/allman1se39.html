<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Reading Files into PSL</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,html --> 
<meta name="src" content="allman1.tex"> 
<meta name="date" content="2014-05-02 18:10:00"> 
<link rel="stylesheet" type="text/css" href="allman1.css"> 
</head><body 
>
<p align="centre"><img src="http://www.reduce-algebra.com/lisp-docs/redlogo.png" width=621 height=60 border=0 alt="REDUCE"></p><table cellspacing="5"><tr><td class="clinks"><a 
href="allman1li9.html#allman1se39.html" >Up</a></td><td class="clinks"><a 
href="allman1se40.html" >Next</a></td><td class="clinks"><a 
href="allman1se38.html" >Prev</a></td><td class="clinks"><a 
href="allman1se38.html#tailallman1se38.html" >PrevTail</a></td><td class="clinks"><a 
href="allman1se39.html#tailallman1se39.html">Tail</a></td></tr></table><h3 class="sectionHead"><span class="titlemark">10.7    </span> <a 
 id="x51-13000010.7"></a>Reading Files into PSL</h3>
<!--l. 923--><p class="noindent" >The following procedures are used to read complete files into PSL, by first calling open, and
then processing each top level form in the file. The effect is similar to what would happen if the
file were typed into PSL. File names are represented by strings. File names may be given using
full system dependent file name conventions.
<!--l. 937--><p class="noindent" ><div class="minipage"><a 
 id="dx51-130001"></a>
<span 
class="ptmb7t-x-x-120">*echo </span>= [Initially: nil]                                                                                                <span 
class="ptmri7t-x-x-120">switch</span>
<br 
class="newline" />&#x00A0;       &#x00A0;<div class="minipage">The switch echo is used to control the echoing of input. When (on echo) is
placed in an input file, the contents of the file are echoed on the standard
output device. Dskin does not change the value of *echo, so one may say
(on echo) before calling dskin, and the input will be echoed.</div>
</div>
<!--l. 944--><p class="noindent" ><div class="minipage"><a 
 id="dx51-130002"></a>
<span 
class="ptmb7t-x-x-120">(dskin NAME:string): nil, abort                                                                                 </span><span 
class="ptmri7t-x-x-120">expr</span>
<br 
class="newline" /><div class="minipage">The  contents  of  the  file  are  processed  as  if  they  were  typed  in.  If  the
processing of the file is aborted the return value will be the identifier abort
and the following error message will be printed.</div>
</div>
<!--l. 946--><p class="noindent" ><span 
class="pcrr7t-x-x-120">&#x22C6;&#x22C6;&#x22C6;&#x22C6;&#x22C6; DSKIN of &#8216;NAME' aborted after N form(s) </span><br 
class="newline" />
<!--l. 948--><p class="noindent" >A count of each top level form is kept as they are processed, which is the value N in the error
message. Once in* has been bound to the channel which represents the open file, each form is
processed by a function similar to the one below.

<div class="verbatim" id="verbatim-308">
&#x00A0;&#x00A0;(de&#x00A0;dskin-step&#x00A0;()
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;(let&#x00A0;((form&#x00A0;(funcall&#x00A0;toploopread&#x22C6;)))
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(cond&#x00A0;((eq&#x00A0;form&#x00A0;$eof$)&#x00A0;'eof)
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;((not&#x00A0;&#x22C6;defn)
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(funcall&#x00A0;toploopprint&#x22C6;&#x00A0;(funcall&#x00A0;toploopeval&#x22C6;&#x00A0;form))
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(dfprint&#x22C6;&#x00A0;(funcall&#x00A0;dfprint&#x22C6;&#x00A0;form))
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(t&#x00A0;(prettyprint&#x00A0;form)))))
</div>
<!--l. 962--><p class="nopar" >
<!--l. 964--><p class="noindent" >Note that the functions used for reading, evaluating and printing are the same as those used in
toploop (see Chapter 15 for more information). If dfprint* has a value (and the switch
*defn is non-nil), then it will be applied to the expression instead of applying the
functions bound to toploopeval* and toploopprint*. If dfprint* does not have a value (and
the switch *defn is nil), then the expression will be simply be printed by a call on
prettyprint.
<!--l. 973--><p class="noindent" >Dskin is flagged ignore. This means that when a file is compiled, a top level application of dskin
will be evaluated but not compiled. For more information about the flag ignore see Chapter
19.
<!--l. 982--><p class="noindent" ><div class="minipage"><a 
 id="dx51-130003"></a>
<span 
class="ptmb7t-x-x-120">(lapin NAME:string): </span><span 
class="cmsy-10x-x-120">{</span><span 
class="ptmb7t-x-x-120">nil, abort</span><span 
class="cmsy-10x-x-120">}                         </span><span 
class="ptmri7t-x-x-120">expr</span>
<br 
class="newline" /><div class="minipage">Almost  identical  to  dskin.  The  difference  is  that  the  function  bound  to
toploopprint*  is  not  applied.  In  general,  this  means  that  the  results  of
evaluation are not printed.</div>
</div>
<!--l. 984--><p class="noindent" >Note that lapin is not flagged ignore as is dskin. This means that a top level application of lapin
is compiled but not evaluated. For more information on how the flags ignore and eval effect
compilation see Chapter 19.
<!--l. 995--><p class="noindent" ><div class="minipage"><a 
 id="dx51-130004"></a>
<span 
class="ptmb7t-x-x-120">(faslin FILENAME:string): nil                                                                                   </span><span 
class="ptmri7t-x-x-120">expr</span>
<br 
class="newline" /><div class="minipage">This is an efficient binary read loop, which fetches blocks of code, constants
and compactly stored ids. It uses a bit-table to relocate code and to identify
special  LISP-oriented  constructs.  FILENAME  must  be  a  complete  file
name.</div></div>

<!--l. 997--><p class="noindent" ><table cellspacing="5"><tr><td class="clinks"><a 
href="allman1li9.html#allman1se39.html" >Up</a></td><td class="clinks"><a 
href="allman1se40.html" >Next</a></td><td class="clinks"><a 
href="allman1se38.html" >Prev</a></td><td class="clinks"><a 
href="allman1se38.html#tailallman1se38.html" >PrevTail</a></td><td class="clinks"><a 
href="allman1se39.html" >Front</a></td></tr></table><a 
 id="tailallman1se39.html"></a>  
</body></html> 
